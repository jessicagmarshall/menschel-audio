{"ast":null,"code":"import _regeneratorRuntime from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/jessicamarshall/Desktop/menschel-fe/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/jessicamarshall/Desktop/menschel-fe/src/components/Main.js\";\n\n/* global fetch */\nimport React, { Component } from 'react';\nimport ReactTable from 'react-table';\nimport Sound from 'react-sound';\nimport 'react-table/react-table.css';\nimport data from '../data/data';\nvar columns = [{\n  Header: 'Input Tag',\n  accessor: 'input'\n}, {\n  Header: 'Output Tag',\n  accessor: 'output'\n}, {\n  Header: 'Audio ID',\n  accessor: 'audio'\n}];\n\nvar Main =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Main, _Component);\n\n  function Main() {\n    var _this;\n\n    _classCallCheck(this, Main);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Main).call(this));\n    _this.state = {\n      rowContent: {\n        input: '',\n        output: '',\n        id: ''\n      },\n      audio: '',\n      paused: false,\n      tagList: [0, 1, 2, 3, 4, 5],\n      // eventually replace this with yonatan's actual tags\n      rowBlue: false,\n      flashingTime: 10,\n      // how many seconds before the end should the bottom bar begin flashing\n      numFlashes: 0,\n      nextRow: '',\n      bgrnd: 'white'\n    };\n    _this.injectThProps = _this.injectThProps.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.generateSet = _this.generateSet.bind(_assertThisInitialized(_assertThisInitialized(_this))); // this.togglePaused = this.togglePaused.bind(this)\n\n    _this.flashBar = _this.flashBar.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Main, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.generateSet();\n    }\n  }, {\n    key: \"generateSet\",\n    value: function generateSet(input) {\n      var _this2 = this;\n\n      if (this.state.audioUrl !== '') {\n        this.setState({\n          audioUrl: ''\n        });\n      }\n\n      var nextRow, outcome;\n      this.state.rowContent.id === '' ? console.log('randomly generate an input tag for the first audio file') : console.log('end of audio file', this.state.rowContent.id, 'with output tag', this.state.rowContent.output);\n      setTimeout(\n      /*#__PURE__*/\n      _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return _this2.getNextIndex();\n\n              case 2:\n                outcome = _context.sent;\n                input === undefined // there is a console.log in this.getNextIndex\n                ? nextRow = outcome[0] : nextRow = input;\n                setTimeout(function () {\n                  console.log('collecting all audio files with input tag', data[nextRow].input, ':', outcome[1]);\n                  setTimeout(function () {\n                    console.log('randomly select audio file', data[nextRow].audio, 'from list of files with input tag', data[nextRow].input, 'and fetch it from the server'); // fetch('http://sentient-computer.local:3003/audioDuration?id=' + nextRow)\n\n                    fetch('http://localhost:3003/audioDuration?id=' + nextRow).then(function (res) {\n                      res.json().then(function (res) {\n                        setTimeout(function () {\n                          console.log('start playing clip', data[nextRow].audio);\n\n                          _this2.setState({\n                            duration: res.duration,\n                            rowIndex: nextRow,\n                            rowContent: {\n                              input: data[nextRow].input,\n                              output: data[nextRow].output,\n                              id: data[nextRow].audio\n                            },\n                            // audioUrl: 'http://sentient-computer.local:3003/audio?id=' + nextRow\n                            audioUrl: 'http://localhost:3003/audio?id=' + nextRow\n                          }); // begin flashing this.state.flashingTime seconds before the end of the sound clip\n\n\n                          setTimeout(_this2.flashBar, 1000 * (_this2.state.duration - _this2.state.flashingTime));\n                        }, 4000);\n                      });\n                    });\n                  }, 6000);\n                }, 4000);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      })), 4000);\n    }\n  }, {\n    key: \"getNextIndex\",\n    value: function () {\n      var _getNextIndex = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var indexArray, audioArray, outputTag, nextIndex, i;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                indexArray = [];\n                audioArray = [];\n                this.state.rowContent.output === '' ? outputTag = this.state.tagList[this.getRandomInt(0, this.state.tagList.length)] : outputTag = this.state.rowContent.output;\n\n                for (i = 0; i < data.length; i++) {\n                  if (data[i].input === outputTag) {\n                    indexArray.push(i);\n                    audioArray.push(data[i].audio);\n                  }\n                }\n\n                console.log('next input tag is', outputTag);\n                nextIndex = this.getRandomInt(0, indexArray.length);\n                return _context2.abrupt(\"return\", [indexArray[nextIndex], audioArray]);\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      return function getNextIndex() {\n        return _getNextIndex.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"getRandomInt\",\n    value: function getRandomInt(min, max) {\n      min = Math.ceil(min);\n      max = Math.floor(max);\n      return Math.floor(Math.random() * (max - min)) + min;\n    }\n  }, {\n    key: \"injectThProps\",\n    value: function injectThProps(state, rowInfo, column) {\n      return {\n        style: {\n          display: 'none'\n        }\n      };\n    } // togglePaused () {\n    //   this.state.paused\n    //     ? this.setState({paused: false})\n    //     : this.setState({paused: true})\n    // }\n\n  }, {\n    key: \"flashBar\",\n    value: function flashBar() {\n      var _this3 = this;\n\n      this.setState({\n        rowBlue: !this.state.rowBlue,\n        numFlashes: this.state.numFlashes + 1\n      });\n      var flashDuration;\n\n      if (this.state.numFlashes < 35) {\n        this.state.numFlashes < 9 ? flashDuration = this.state.flashingTime / 20 // 8 flashes at 1/20 of the time\n        : this.state.numFlashes < 25 ? flashDuration = this.state.flashingTime / 40 // 16 flashes at 1/40 of the time\n        : flashDuration = this.state.flashingTime / 80; // 10 flashes at 1/80 of the time\n\n        setTimeout(this.flashBar, 1000 * flashDuration);\n      } else {\n        setTimeout(function () {\n          _this3.setState({\n            numFlashes: 0,\n            rowBlue: !_this3.state.rowBlue\n          });\n        }, 1000 * this.state.flashingTime / 80);\n        this.generateSet();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n\n      console.log(window.innerWidth);\n      return React.createElement(\"div\", {\n        style: {\n          backgroundColor: this.state.bgrnd\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(Sound, {\n        url: this.state.audioUrl || '',\n        playStatus: this.state.paused ? Sound.status.PAUSED : Sound.status.PLAYING,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }), React.createElement(ReactTable, {\n        data: data,\n        columns: columns,\n        showPagination: false,\n        sortable: false,\n        loadingText: null,\n        defaultPageSize: data.length + 2,\n        getTdProps: function getTdProps(state, rowInfo, column, instance) {\n          if (typeof rowInfo !== 'undefined') {\n            return {\n              onClick: function onClick(e, handleOriginal) {\n                _this4.generateSet(rowInfo.index);\n              },\n              style: {\n                background: rowInfo.index !== _this4.state.rowIndex ? 'white' : _this4.state.rowBlue ? 'purple' : 'yellow',\n                color: rowInfo.index !== _this4.state.rowIndex ? 'black' : _this4.state.rowBlue ? 'white' : 'black'\n              }\n            };\n          } else {\n            return {};\n          }\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }), React.createElement(ReactTable, {\n        data: [{\n          input: this.state.rowContent.input,\n          output: this.state.rowContent.output,\n          audio: this.state.rowContent.id\n        }],\n        columns: columns,\n        getTheadThProps: this.injectThProps,\n        showPagination: false,\n        sortable: false,\n        minRows: 1,\n        loadingText: null,\n        style: {\n          position: 'fixed',\n          width: '100%',\n          backgroundColor: this.state.rowBlue ? 'purple' : 'yellow',\n          color: this.state.rowBlue ? 'white' : 'black',\n          bottom: 0,\n          height: 60\n        },\n        getTdProps: function getTdProps(state, rowInfo, column, instance) {\n          return {\n            onClick: function onClick(e, handleOriginal) {// this.togglePaused()\n            }\n          };\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return Main;\n}(Component);\n\nexport default Main;","map":{"version":3,"sources":["/Users/jessicamarshall/Desktop/menschel-fe/src/components/Main.js"],"names":["React","Component","ReactTable","Sound","data","columns","Header","accessor","Main","state","rowContent","input","output","id","audio","paused","tagList","rowBlue","flashingTime","numFlashes","nextRow","bgrnd","injectThProps","bind","generateSet","flashBar","audioUrl","setState","outcome","console","log","setTimeout","getNextIndex","undefined","fetch","then","res","json","duration","rowIndex","indexArray","audioArray","outputTag","getRandomInt","length","i","push","nextIndex","min","max","Math","ceil","floor","random","rowInfo","column","style","display","flashDuration","window","innerWidth","backgroundColor","status","PAUSED","PLAYING","instance","onClick","e","handleOriginal","index","background","color","position","width","bottom","height"],"mappings":"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","sourcesContent":["/* global fetch */\n\nimport React, { Component } from 'react'\nimport ReactTable from 'react-table'\nimport Sound from 'react-sound'\nimport 'react-table/react-table.css'\nimport data from '../data/data'\n\nconst columns = [{\n  Header: 'Input Tag',\n  accessor: 'input'\n}, {\n  Header: 'Output Tag',\n  accessor: 'output'\n}, {\n  Header: 'Audio ID',\n  accessor: 'audio'\n}]\n\nclass Main extends Component {\n  constructor () {\n    super()\n    this.state = {\n      rowContent: {input: '', output: '', id: ''},\n      audio: '',\n      paused: false,\n      tagList: [0, 1, 2, 3, 4, 5], // eventually replace this with yonatan's actual tags\n      rowBlue: false,\n      flashingTime: 10, // how many seconds before the end should the bottom bar begin flashing\n      numFlashes: 0,\n      nextRow: '',\n      bgrnd: 'white'\n    }\n    this.injectThProps = this.injectThProps.bind(this)\n    this.generateSet = this.generateSet.bind(this)\n    // this.togglePaused = this.togglePaused.bind(this)\n    this.flashBar = this.flashBar.bind(this)\n  }\n\n  componentWillMount () {\n    this.generateSet()\n  }\n\n  generateSet (input) {\n    if (this.state.audioUrl !== '') {\n      this.setState({audioUrl: ''})\n    }\n    let nextRow, outcome\n    this.state.rowContent.id === ''\n      ? console.log('randomly generate an input tag for the first audio file')\n      : console.log('end of audio file', this.state.rowContent.id, 'with output tag', this.state.rowContent.output)\n    setTimeout(async () => {\n      outcome = await this.getNextIndex()\n      input === undefined\n        // there is a console.log in this.getNextIndex\n        ? nextRow = outcome[0]\n        : nextRow = input\n      setTimeout(() => {\n        console.log('collecting all audio files with input tag', data[nextRow].input, ':', outcome[1])\n        setTimeout(() => {\n          console.log('randomly select audio file', data[nextRow].audio, 'from list of files with input tag', data[nextRow].input, 'and fetch it from the server')\n          // fetch('http://sentient-computer.local:3003/audioDuration?id=' + nextRow)\n          fetch('http://localhost:3003/audioDuration?id=' + nextRow)\n            .then(res => {\n              res.json()\n                .then(res => {\n                  setTimeout(() => {\n                    console.log('start playing clip', data[nextRow].audio)\n                    this.setState({\n                      duration: res.duration,\n                      rowIndex: nextRow,\n                      rowContent: {input: data[nextRow].input, output: data[nextRow].output, id: data[nextRow].audio},\n                      // audioUrl: 'http://sentient-computer.local:3003/audio?id=' + nextRow\n                      audioUrl: 'http://localhost:3003/audio?id=' + nextRow\n                    })\n                    // begin flashing this.state.flashingTime seconds before the end of the sound clip\n                    setTimeout(this.flashBar, 1000 * (this.state.duration - this.state.flashingTime))\n                  }, 4000)\n                })\n            })\n        }, 6000)\n      }, 4000)\n    }, 4000)\n  }\n\n  async getNextIndex () {\n    let indexArray = []\n    let audioArray = []\n    let outputTag\n    let nextIndex\n    this.state.rowContent.output === ''\n      ? outputTag = this.state.tagList[this.getRandomInt(0, this.state.tagList.length)]\n      : outputTag = this.state.rowContent.output\n    for (let i = 0; i < data.length; i++) {\n      if (data[i].input === outputTag) {\n        indexArray.push(i)\n        audioArray.push(data[i].audio)\n      }\n    }\n    console.log('next input tag is', outputTag)\n    nextIndex = this.getRandomInt(0, indexArray.length)\n    return [indexArray[nextIndex], audioArray]\n  }\n\n  getRandomInt (min, max) {\n    min = Math.ceil(min)\n    max = Math.floor(max)\n    return Math.floor(Math.random() * (max - min)) + min\n  }\n\n  injectThProps (state, rowInfo, column) {\n    return {\n      style: { display: 'none' }\n    }\n  }\n\n  // togglePaused () {\n  //   this.state.paused\n  //     ? this.setState({paused: false})\n  //     : this.setState({paused: true})\n  // }\n\n  flashBar () {\n    this.setState({rowBlue: !this.state.rowBlue, numFlashes: this.state.numFlashes + 1})\n    let flashDuration\n    if (this.state.numFlashes < 35) {\n      this.state.numFlashes < 9\n        ? flashDuration = this.state.flashingTime / 20 // 8 flashes at 1/20 of the time\n        : this.state.numFlashes < 25\n          ? flashDuration = this.state.flashingTime / 40 // 16 flashes at 1/40 of the time\n          : flashDuration = this.state.flashingTime / 80 // 10 flashes at 1/80 of the time\n      setTimeout(this.flashBar,\n        1000 * flashDuration\n      )\n    } else {\n      setTimeout(() => {\n        this.setState({numFlashes: 0, rowBlue: !this.state.rowBlue})\n      }, 1000 * this.state.flashingTime / 80)\n      this.generateSet()\n    }\n  }\n\n  render () {\n    console.log(window.innerWidth)\n    return (\n      <div style={{backgroundColor: this.state.bgrnd}}>\n        <Sound url={this.state.audioUrl || ''}\n          playStatus={this.state.paused ? Sound.status.PAUSED : Sound.status.PLAYING}\n        />\n        <ReactTable\n          data={data}\n          columns={columns}\n          showPagination={false}\n          sortable={false}\n          loadingText={null}\n          defaultPageSize={data.length + 2}\n          getTdProps={(state, rowInfo, column, instance) => {\n            if (typeof rowInfo !== 'undefined') {\n              return {\n                onClick: (e, handleOriginal) => {\n                  this.generateSet(rowInfo.index)\n                },\n                style: {\n                  background: rowInfo.index !== this.state.rowIndex ? 'white' : this.state.rowBlue ? 'purple' : 'yellow',\n                  color: rowInfo.index !== this.state.rowIndex ? 'black' : this.state.rowBlue ? 'white' : 'black'\n                }\n              }\n            } else {\n              return {}\n            }\n          }}\n        />\n        <ReactTable\n          data={[{\n            input: this.state.rowContent.input,\n            output: this.state.rowContent.output,\n            audio: this.state.rowContent.id\n          }]}\n          columns={columns}\n          getTheadThProps={this.injectThProps}\n          showPagination={false}\n          sortable={false}\n          minRows={1}\n          loadingText={null}\n          style={{\n            position: 'fixed',\n            width: '100%',\n            backgroundColor: this.state.rowBlue ? 'purple' : 'yellow',\n            color: this.state.rowBlue ? 'white' : 'black',\n            bottom: 0,\n            height: 60}}\n          getTdProps={(state, rowInfo, column, instance) => {\n            return {\n              onClick: (e, handleOriginal) => {\n                // this.togglePaused()\n              }\n            }\n          }}\n        />\n      </div>\n    )\n  }\n}\n\nexport default Main\n"]},"metadata":{},"sourceType":"module"}